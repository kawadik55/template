parserES.js - скрипт парсера Расписаний во всех городах РЗФ.
Пути и имена файлов загружаются из файла paths.json. При его отсутствии он будет создан.
Для вчерашнего и завтрашнего файлов в имена добавляются префиксы 'yesterday_' и 'tomorrow_'.
В каждом файле Расписания есть поле "UnixTime" для привязки ко времени сервера.
Ключи объекта в файле paths.json:
"DirRaspis" - массив путей к директориям для сохранения файлов, относительно рабочей директории;
"FileRaspisHtml" - имя файла в формате html;
"Links" - массив ссылок на что-либо, добавляется в конце текста расписания, может отсутствовать;
"StopListTowns" - массив названий городов, которые не будут включаться в общий список.

Перед запуском скрипта parserES.js необходимо заполнить объект в файле paths.json своими путями и именами, если нужно.
Запустить парсер можно и в Докере, читать файл Docker.txt
Готовый образ для Докера "kawadiyk/parseres:latest" можно загрузить из DockerHub.
Запуск парсера лучше всего делать в первый час наступивших суток по местному времени, чтобы правильно
получить сегодняшний файл, как точку отсчета. Местное время необходимо учитывать при настроке cron'а.
//-----------------------------------------------------------------------------------
Запуск контейнера в докере является самым простым способом запуска парсера, если, конечно, пакет докера
уже установлен в системе. Установка докера подробно описана в файле Docker.txt в папке Doc репозитория.
Для того, чтобы развернуть бота в системе, нужно всего лишь создать нужные папки и запустить контейнер бота.
Итак:
1. В домашней папке пользователя (например: /home/anton, в дальнейшем будем звать ее ДОМ) нужно создать основную папку
местности, например Minsk (в дальнейшем будем звать ее РЕГИОН), а внутри нее создать папку для этого скрипта ParserEg,
или с любым другим именем (в дальнейшем будем звать ее БОТ). Тогда полный путь к скрипту будет выглядеть так:
ДОМ/РЕГИОН/БОТ
а если в расшифрованном виде, то:
/home/anton/Minsk/ParserES
Права записи в эти папки лучше открыть для всех, чтоб не было проблем при записи логов из системы.
Папка скрипта БОТ должна иметь уникальное имя, отличное от других папок с ботами в этой местности.

2. Теперь запустим контейнер, и он сохранит файлы Ежика на сегодня в указанные ранее места:

docker run --rm --name name_bot -v ДОМ/РЕГИОН:/home/pi/РЕГИОН:rw -t -e "CURRENT_DIR=/home/pi/РЕГИОН/БОТ" --user "$(id -u):$(id -g)" kawadiyk/parseres ./parserES

где имя контейнера 'name_bot' можно заменить на любое другое, лишь бы самому понятно было, что это за контейнер.
Например: parseres, и т.п.
Само собой, ДОМ, РЕГИОН и БОТ нужно заменить на свои пути и директории, о которых мы договорились выше.
Отработав и создав файлы, контейнер самоудалится.
Если предполагается запускать контейнер из crontab'a (что логично), то команду запуска можно дополнить выводом
состояний в лог-файл:

05,15 00 * * * docker run --rm --name name_bot -v ДОМ/РЕГИОН:/home/pi/РЕГИОН:rw -t -e "CURRENT_DIR=/home/pi/РЕГИОН/БОТ" --user "$(id -u):$(id -g)" kawadiyk/parseres ./parserES >> ДОМ/РЕГИОН/log/cronlog.log  2>&1

Вот и все, что нужно сделать для запуска бота в докер-контейнере!
//-----------------------------------------------------------------------------------
Удачи вам!
